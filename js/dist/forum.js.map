{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@dhtml/flarum-leaderboard/webpack/bootstrap","webpack://@dhtml/flarum-leaderboard/webpack/runtime/compat get default export","webpack://@dhtml/flarum-leaderboard/webpack/runtime/define property getters","webpack://@dhtml/flarum-leaderboard/webpack/runtime/hasOwnProperty shorthand","webpack://@dhtml/flarum-leaderboard/webpack/runtime/make namespace object","webpack://@dhtml/flarum-leaderboard/external root \"flarum.core.compat['common/app']\"","webpack://@dhtml/flarum-leaderboard/./src/common/index.ts","webpack://@dhtml/flarum-leaderboard/external root \"flarum.core.compat['forum/app']\"","webpack://@dhtml/flarum-leaderboard/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@dhtml/flarum-leaderboard/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@dhtml/flarum-leaderboard/external root \"flarum.core.compat['common/helpers/avatar']\"","webpack://@dhtml/flarum-leaderboard/external root \"flarum.core.compat['common/components/Page']\"","webpack://@dhtml/flarum-leaderboard/external root \"flarum.core.compat['forum/components/IndexPage']\"","webpack://@dhtml/flarum-leaderboard/external root \"flarum.core.compat['common/components/Button']\"","webpack://@dhtml/flarum-leaderboard/external root \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@dhtml/flarum-leaderboard/external root \"flarum.core.compat['common/helpers/listItems']\"","webpack://@dhtml/flarum-leaderboard/external root \"flarum.core.compat['common/helpers/username']\"","webpack://@dhtml/flarum-leaderboard/external root \"flarum.core.compat['common/components/Link']\"","webpack://@dhtml/flarum-leaderboard/external root \"flarum.core.compat['common/Component']\"","webpack://@dhtml/flarum-leaderboard/external root \"flarum.core.compat['common/helpers/icon']\"","webpack://@dhtml/flarum-leaderboard/./src/forum/components/RankingImage.tsx","webpack://@dhtml/flarum-leaderboard/./src/forum/components/RankingsPage.js","webpack://@dhtml/flarum-leaderboard/./src/forum/index.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/app'];","import app from 'flarum/common/app';\n\napp.initializers.add('dhtml/flarum-leaderboard', () => {\n  //console.log('[dhtml/flarum-leaderboard] Hello, forum and admin!');\n});\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","function _setPrototypeOf(t, e) {\n  return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) {\n    return t.__proto__ = e, t;\n  }, _setPrototypeOf(t, e);\n}\nexport { _setPrototypeOf as default };","import setPrototypeOf from \"./setPrototypeOf.js\";\nfunction _inheritsLoose(t, o) {\n  t.prototype = Object.create(o.prototype), t.prototype.constructor = t, setPrototypeOf(t, o);\n}\nexport { _inheritsLoose as default };","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/avatar'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Page'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/IndexPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LoadingIndicator'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/listItems'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/username'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Link'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/icon'];","import app from 'flarum/forum/app';\r\nimport Component, { ComponentAttrs } from 'flarum/common/Component';\r\nimport type Mithril from 'mithril';\r\nimport icon from 'flarum/common/helpers/icon';\r\n\r\ninterface RankingImageAttrs extends ComponentAttrs {\r\n  place: number;\r\n}\r\n\r\nexport default class RankingImage extends Component<RankingImageAttrs> {\r\n  view() {\r\n    const imgUrl = app.forum.attribute(`fof-gamification.topimage${this.attrs.place}Url`);\r\n    const place = this.attrs.place;\r\n\r\n    return imgUrl ? (\r\n      <img className={`rankings-mobile rankings-image rankings-${place}`} src={imgUrl} alt=\"\" />\r\n    ) : (\r\n      <td className={`rankings-mobile rankings-${place}`}>{icon('fas fa-trophy')}</td>\r\n    );\r\n  }\r\n}\r\n","import app from 'flarum/forum/app';\r\nimport avatar from 'flarum/common/helpers/avatar';\r\nimport Page from 'flarum/common/components/Page';\r\nimport IndexPage from 'flarum/forum/components/IndexPage';\r\nimport Button from 'flarum/common/components/Button';\r\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\r\nimport listItems from 'flarum/common/helpers/listItems';\r\nimport username from 'flarum/common/helpers/username';\r\nimport Link from 'flarum/common/components/Link';\r\nimport RankingImage from './RankingImage';\r\n\r\n/**\r\n * This page re-uses Flarum's IndexPage CSS classes\r\n */\r\nexport default class RankingsPage extends Page {\r\n  oninit(vnode) {\r\n    super.oninit(vnode);\r\n\r\n    if (!app.forum.attribute('canViewRankingPage')) {\r\n      m.route.set('/');\r\n    }\r\n\r\n    app.setTitle(app.translator.trans('dhtml-leaderboard.forum.leaderboard'));\r\n\r\n    this.loading = true;\r\n    this.users = [];\r\n    this.refresh();\r\n  }\r\n\r\n  view() {\r\n    let loading;\r\n\r\n    if (this.loading) {\r\n      loading = LoadingIndicator.component();\r\n    } else {\r\n      loading = Button.component(\r\n        {\r\n          className: 'Button',\r\n          onclick: this.loadMore.bind(this),\r\n        },\r\n        app.translator.trans('core.forum.discussion_list.load_more_button')\r\n      );\r\n    }\r\n\r\n    return (\r\n      <div className=\"IndexPage\">\r\n        {IndexPage.prototype.hero()}\r\n        <div className=\"container\">\r\n          <div className=\"sideNavContainer\">\r\n            <nav className=\"IndexPage-nav sideNav\">\r\n              <ul>{listItems(IndexPage.prototype.sidebarItems().toArray())}</ul>\r\n            </nav>\r\n            <div className=\"IndexPage-results sideNavOffset\">\r\n\r\n              <header class=\"Hero PageHero leaderboard-hero\">\r\n                <div class=\"iconcontainer\">\r\n                  <div class=\"fontico\"><i class=\"fas fa-trophy\"></i> &nbsp;</div>\r\n                  <div class=\"icocont\">\r\n                    <div class=\"titolo1\">Leaderboard</div>\r\n                  </div>\r\n                </div>\r\n              </header>\r\n\r\n              <table class=\"rankings\">\r\n                <tr>\r\n                  <th className=\"rankings-mobile\">{app.translator.trans('fof-gamification.forum.ranking.rank')}</th>\r\n                  <th>{app.translator.trans('fof-gamification.forum.ranking.name')}</th>\r\n                  <th>{app.translator.trans('fof-gamification.forum.ranking.amount')}</th>\r\n                </tr>\r\n                {this.users.map((user, i) => {\r\n                  ++i;\r\n                  return [\r\n                    <tr className={'ranking-' + i}>\r\n                      {i < 4 ? <RankingImage place={i}/> :\r\n                        <td className=\"rankings-4 rankings-mobile\">{this.addOrdinalSuffix(i)}</td>}\r\n                      <td>\r\n                        <div className=\"PostUser\">\r\n                          <h3 className=\"rankings-info\">\r\n                            <Link href={app.route.user(user)} force={true}>\r\n                              {i < 11 ? avatar(user, {className: 'info-avatar rankings-' + i + '-avatar'}) : ''} {username(user)}\r\n                            </Link>\r\n                          </h3>\r\n                        </div>\r\n                      </td>\r\n                      {i < 11 ? <td className={'rankings-' + i}>{user.points()}</td> :\r\n                        <td className=\"rankings-4\">{user.points()}</td>}\r\n                    </tr>,\r\n                  ];\r\n                })}\r\n              </table>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  refresh(clear = true) {\r\n    if (clear) {\r\n      this.loading = true;\r\n      this.users = [];\r\n    }\r\n\r\n    return this.loadResults().then(\r\n      (results) => {\r\n        this.users = [];\r\n        this.parseResults(results);\r\n      },\r\n      () => {\r\n        this.loading = false;\r\n        m.redraw();\r\n      }\r\n    );\r\n  }\r\n\r\n  addOrdinalSuffix(i) {\r\n    if (app.data.locale === 'en') {\r\n      const j = i % 10;\r\n      const k = i % 100;\r\n\r\n      if (j === 1 && k !== 11) {\r\n        return i + 'st';\r\n      } else if (j === 2 && k !== 12) {\r\n        return i + 'nd';\r\n      } else if (j === 3 && k !== 13) {\r\n        return i + 'rd';\r\n      }\r\n      return i + 'th';\r\n    } else {\r\n      return i;\r\n    }\r\n  }\r\n\r\n  loadResults(offset) {\r\n    const params = {};\r\n    params.page = {\r\n      offset: offset,\r\n      limit: '6',\r\n    };\r\n\r\n    return app.store.find('rankings', params);\r\n  }\r\n\r\n  loadMore() {\r\n    this.loading = true;\r\n\r\n    this.loadResults(this.users.length).then(this.parseResults.bind(this));\r\n  }\r\n\r\n  parseResults(results) {\r\n    [].push.apply(this.users, results);\r\n\r\n    this.loading = false;\r\n\r\n    this.users.sort(function (a, b) {\r\n      return parseFloat(b.points()) - parseFloat(a.points());\r\n    });\r\n\r\n    m.redraw();\r\n\r\n    return results;\r\n  }\r\n}\r\n","import app from 'flarum/forum/app';\nimport RankingsPage from \"./components/RankingsPage\";\n\napp.initializers.add('dhtml/flarum-leaderboard', () => {\n  app.routes.leaderboard = { path: '/leaderboard', component: RankingsPage };\n});\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","flarum","core","compat","app","add","_setPrototypeOf","t","e","setPrototypeOf","bind","__proto__","_inheritsLoose","create","constructor","RankingImage","_Component","apply","arguments","view","imgUrl","attribute","this","attrs","place","m","className","src","alt","icon","Component","RankingsPage","_Page","_proto","oninit","vnode","route","set","trans","loading","users","refresh","_this","LoadingIndicator","Button","onclick","loadMore","IndexPage","hero","listItems","sidebarItems","toArray","class","map","user","i","addOrdinalSuffix","Link","href","force","avatar","username","points","clear","_this2","loadResults","then","results","parseResults","redraw","locale","j","k","offset","params","page","limit","find","length","push","sort","b","parseFloat","Page","leaderboard","path","component"],"sourceRoot":""}